---
title: "microsoft/agent-lightning: The absolute trainer to light up AI agents."
source: "https://github.com/microsoft/agent-lightning"
author:
  - "[[cptnm3]]"
published:
created: 2025-11-03
description: "The absolute trainer to light up AI agents. Contribute to microsoft/agent-lightning development by creating an account on GitHub."
tags:
  - "clippings"
---
**[agent-lightning](https://github.com/microsoft/agent-lightning)** Public

The absolute trainer to light up AI agents.

[microsoft.github.io/agent-lightning/](https://microsoft.github.io/agent-lightning/ "https://microsoft.github.io/agent-lightning/")

[MIT license](https://github.com/microsoft/agent-lightning/blob/main/LICENSE)

[Code of conduct](https://github.com/microsoft/.github/blob/main/CODE_OF_CONDUCT.md)

[Security policy](https://github.com/microsoft/agent-lightning/blob/main/SECURITY.md)

[6.3k stars](https://github.com/microsoft/agent-lightning/stargazers) [460 forks](https://github.com/microsoft/agent-lightning/forks) [28 watching](https://github.com/microsoft/agent-lightning/watchers) [Branches](https://github.com/microsoft/agent-lightning/branches) [Tags](https://github.com/microsoft/agent-lightning/tags) [Activity](https://github.com/microsoft/agent-lightning/activity) [Custom properties](https://github.com/microsoft/agent-lightning/custom-properties)

Public repository

[Open in github.dev](https://github.dev/) [Open in a new github.dev tab](https://github.dev/) [Open in codespace](https://github.com/codespaces/new/microsoft/agent-lightning?resume=1)

<table><thead><tr><th colspan="2"><span>Name</span></th><th colspan="1"><span>Name</span></th><th><p><span>Last commit message</span></p></th><th colspan="1"><p><span>Last commit date</span></p></th></tr></thead><tbody><tr><td colspan="3"><div><span>and</span><p><span>Vishal</span></p></div><p><span><a href="https://github.com/microsoft/agent-lightning/commit/55fbe66fe7b9c9f4bb7bb402cc9963eb3105480c">docs: fix typos in train-first-agent.md (</a><a href="https://github.com/microsoft/agent-lightning/pull/260">#260</a><a href="https://github.com/microsoft/agent-lightning/commit/55fbe66fe7b9c9f4bb7bb402cc9963eb3105480c">)</a></span></p><p><span><a href="https://github.com/microsoft/agent-lightning/commit/55fbe66fe7b9c9f4bb7bb402cc9963eb3105480c">55fbe66</a> Â·</span></p><p><a href="https://github.com/microsoft/agent-lightning/commits/main/"><span><span><span>150 Commits</span></span></span></a></p></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/.github/workflows"><span>.github/</span> <span>workflows</span></a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/.github/workflows"><span>.github/</span> <span>workflows</span></a></p></td><td><p><a href="https://github.com/microsoft/agent-lightning/commit/c453c41fd2993300d7e5151cf03817c6ff8c745e">Fix tests-full failure to checkout PR branch (</a><a href="https://github.com/microsoft/agent-lightning/pull/253">#253</a><a href="https://github.com/microsoft/agent-lightning/commit/c453c41fd2993300d7e5151cf03817c6ff8c745e">)</a></p></td><td></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/agentlightning">agentlightning</a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/agentlightning">agentlightning</a></p></td><td></td><td></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/docs">docs</a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/docs">docs</a></p></td><td><p><a href="https://github.com/microsoft/agent-lightning/commit/55fbe66fe7b9c9f4bb7bb402cc9963eb3105480c">docs: fix typos in train-first-agent.md (</a><a href="https://github.com/microsoft/agent-lightning/pull/260">#260</a><a href="https://github.com/microsoft/agent-lightning/commit/55fbe66fe7b9c9f4bb7bb402cc9963eb3105480c">)</a></p></td><td></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/examples">examples</a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/examples">examples</a></p></td><td></td><td></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/scripts">scripts</a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/scripts">scripts</a></p></td><td></td><td></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/tests">tests</a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/tree/main/tests">tests</a></p></td><td></td><td></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/blob/main/.gitignore">.gitignore</a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/blob/main/.gitignore">.gitignore</a></p></td><td><p><a href="https://github.com/microsoft/agent-lightning/commit/f8c45b6ca8e0033019d03d6b6ebb3af072c4a743">propose fix a couple of typos and avoid emacs backup files (</a><a href="https://github.com/microsoft/agent-lightning/pull/237">#237</a><a href="https://github.com/microsoft/agent-lightning/commit/f8c45b6ca8e0033019d03d6b6ebb3af072c4a743">)</a></p></td><td></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/blob/main/.pre-commit-config.yaml">.pre-commit-config.yaml</a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/blob/main/.pre-commit-config.yaml">.pre-commit-config.yaml</a></p></td><td><p><a href="https://github.com/microsoft/agent-lightning/commit/c4b829dbe73355ee7fa08c4490c03285d82ead6c">Update README and documentation README (</a><a href="https://github.com/microsoft/agent-lightning/pull/183">#183</a><a href="https://github.com/microsoft/agent-lightning/commit/c4b829dbe73355ee7fa08c4490c03285d82ead6c">)</a></p></td><td></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/blob/main/.python-version">.python-version</a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/blob/main/.python-version">.python-version</a></p></td><td><p><a href="https://github.com/microsoft/agent-lightning/commit/8e06fe690271a958f4781ddf60b2188444bea422">Migrate to use uv as dependency manager (</a><a href="https://github.com/microsoft/agent-lightning/pull/170">#170</a><a href="https://github.com/microsoft/agent-lightning/commit/8e06fe690271a958f4781ddf60b2188444bea422">)</a></p></td><td></td></tr><tr><td colspan="2"><p><a href="https://github.com/microsoft/agent-lightning/blob/main/LICENSE">LICENSE</a></p></td><td colspan="1"><p><a href="https://github.com/microsoft/agent-lightning/blob/main/LICENSE">LICENSE</a></p></td><td><p><a href="https://github.com/microsoft/agent-lightning/commit/3eb725faded0ed6a4102108a284dde990862d64e">Update pre-commit configurations and bump to 0.2.0 (</a><a href="https://github.com/microsoft/agent-lightning/pull/102">#102</a><a href="https://github.com/microsoft/agent-lightning/commit/3eb725faded0ed6a4102108a284dde990862d64e">)</a></p></td><td></td></tr><tr><td colspan="3"></td></tr></tbody></table>

[![Agent-lightning-banner](https://github.com/microsoft/agent-lightning/raw/main/docs/assets/readme-banner.svg)](https://github.com/microsoft/agent-lightning/blob/main/docs/assets/readme-banner.svg)

## Agent Lightningâš¡

**The absolute trainer to light up AI agents.**

Join our [Discord community](https://discord.gg/RYk7CdvDR7) to connect with other users and contributors.

- Turn your agent into an optimizable beast with **ZERO CODE CHANGE** (almost)! ðŸ’¤
- Build with **ANY** agent framework (LangChain, OpenAI Agent SDK, AutoGen, CrewAI, Microsoft Agent Framework...); or even WITHOUT agent framework (Python OpenAI). You name it! ðŸ¤–
- **Selectively** optimize one or more agents in a multi-agent system. ðŸŽ¯
- Embraces **Algorithms** like Reinforcement Learning, Automatic Prompt Optimization, Supervised Fine-tuning and more. ðŸ¤—

Read more on our [documentation website](https://microsoft.github.io/agent-lightning/).

[![Agent-Lightning Core Quickstart](https://github.com/microsoft/agent-lightning/raw/main/docs/assets/readme-diff.svg)](https://github.com/microsoft/agent-lightning/blob/main/docs/assets/readme-diff.svg)

## âš¡ Installation

```
pip install agentlightning
```

Please refer to our [installation guide](https://microsoft.github.io/agent-lightning/stable/tutorials/installation/) for more details.

To start using Agent-lightning, check out our [documentation](https://microsoft.github.io/agent-lightning/) and [examples](https://github.com/microsoft/agent-lightning/blob/main/examples).

## âš¡ Articles

- 10/22/2025 [No More Retokenization Drift: Returning Token IDs via the OpenAI Compatible API Matters in Agent RL](https://blog.vllm.ai/2025/10/22/agent-lightning.html) vLLM blog. See also [Zhihu writeup](https://zhuanlan.zhihu.com/p/1965067274642785725).
- 8/11/2025 [Training AI Agents to Write and Self-correct SQL with Reinforcement Learning](https://medium.com/@yugez/training-ai-agents-to-write-and-self-correct-sql-with-reinforcement-learning-571ed31281ad) Medium.
- 8/5/2025 [Agent Lightning: Train ANY AI Agents with Reinforcement Learning](https://arxiv.org/abs/2508.03680) arXiv paper.
- 7/26/2025 [We discovered an approach to train any AI agent with RL, with (almost) zero code changes.](https://www.reddit.com/r/LocalLLaMA/comments/1m9m670/we_discovered_an_approach_to_train_any_ai_agent/) Reddit.
- 6/6/2025 [Agent Lightning - Microsoft Research](https://www.microsoft.com/en-us/research/project/agent-lightning/) Project page.
- [DeepWerewolf](https://github.com/af-74413592/DeepWerewolf) â€” A case study of agent RL training for the Chinese Werewolf game built with AgentScope and Agent Lightning.
- [AgentFlow](https://agentflow.stanford.edu/) â€” A modular multi-agent framework that combines planner, executor, verifier, and generator agents with the Flow-GRPO algorithm to tackle long-horizon, sparse-reward tasks.

## âš¡ Architecture

Agent Lightning keeps the moving parts to a minimum so you can focus on your idea, not the plumbing. Your agent continues to run as usual; you can still use any agent framework you like; you drop in the lightweight `agl.emit_xxx()` helper, or let the tracer collect every prompt, tool call, and reward. Those events become structured spans that flow into the LightningStore, a central hub that keeps tasks, resources, and traces in sync.

On the other side of the store sits the algorithm you choose, or write yourself. The algorithm reads spans, learns from them, and posts updated resources such as refined prompt templates or new policy weights. The Trainer ties it all together: it streams datasets to runners, ferries resources between the store and the algorithm, and updates the inference engine when improvements land. You can either stop there, or simply let the same loop keep turning.

No rewrites, no lock-in, just a clear path from first rollout to steady improvement.

[![Agent-lightning Architecture](https://github.com/microsoft/agent-lightning/raw/main/docs/assets/readme-architecture.svg)](https://github.com/microsoft/agent-lightning/blob/main/docs/assets/readme-architecture.svg)

| Workflow | Status |
| --- | --- |
| CPU Tests |  |
| GPU Tests |  |
| Examples Integration |  |
| Latest Dependency Compatibility |  |
| Legacy Examples Compatibility |  |

## âš¡ Citation

If you find Agent Lightning useful in your research or projects, please cite our paper:

```
@misc{luo2025agentlightningtrainai,
      title={Agent Lightning: Train ANY AI Agents with Reinforcement Learning},
      author={Xufang Luo and Yuge Zhang and Zhiyuan He and Zilong Wang and Siyun Zhao and Dongsheng Li and Luna K. Qiu and Yuqing Yang},
      year={2025},
      eprint={2508.03680},
      archivePrefix={arXiv},
      primaryClass={cs.AI},
      url={https://arxiv.org/abs/2508.03680},
}
```

## âš¡ Contributing

This project welcomes contributions and suggestions. Start by reading the [Contributing Guide](https://github.com/microsoft/agent-lightning/blob/main/docs/community/contributing.md) for environment setup, branching conventions, and pull request expectations. Most contributions require you to agree to a Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us the rights to use your contribution. For details, visit [https://cla.opensource.microsoft.com](https://cla.opensource.microsoft.com/).

When you submit a pull request, a CLA bot will automatically determine whether you need to provide a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions provided by the bot. You will only need to do this once across all repos using our CLA.

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/). For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or contact [opencode@microsoft.com](https://github.com/microsoft/) with any additional questions or comments.

## âš¡ Trademarks

This project may contain trademarks or logos for projects, products, or services. Authorized use of Microsoft trademarks or logos is subject to and must follow [Microsoft's Trademark & Brand Guidelines](https://www.microsoft.com/en-us/legal/intellectualproperty/trademarks/usage/general). Use of Microsoft trademarks or logos in modified versions of this project must not cause confusion or imply Microsoft sponsorship. Any use of third-party trademarks or logos are subject to those third-party's policies.

This project has been evaluated and certified to comply with the Microsoft Responsible AI Standard. The team will continue to monitor and maintain the repository, addressing any severe issues, including potential harms, if they arise.

## âš¡ License

This project is licensed under the MIT License. See the [LICENSE](https://github.com/microsoft/agent-lightning/blob/main/LICENSE) file for details.

## Releases 5

[\+ 4 releases](https://github.com/microsoft/agent-lightning/releases)

## Deployments 129

- [github-pages](https://github.com/microsoft/agent-lightning/deployments/github-pages)

[\+ 128 deployments](https://github.com/microsoft/agent-lightning/deployments)

## Languages

- [Python 99.1%](https://github.com/microsoft/agent-lightning/search?l=python)
- Other 0.9%